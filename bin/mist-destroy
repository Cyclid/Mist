#!/usr/bin/env ruby
$LOAD_PATH.push File.expand_path('../../lib', __FILE__)

require 'optparse'
require 'mist'

options = {}
OptionParser.new do |opts|
  opts.on('-n', '--name NAME', 'Container name') do |name|
    options[:name] = name
  end
end.parse!

name = options[:name]
abort 'You must supply a container name' if name.nil?

begin
  container = Mist::LXCContainer.new(name)
  raise 'container does not exist' unless container.exists?

  Mist.logger.info "Destroying container #{name}"
  container.destroy
rescue StandardError => ex
  Mist.logger.error "Failed to destroy container #{name}: #{ex}"
  abort
end
